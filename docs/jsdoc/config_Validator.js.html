<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: config/Validator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: config/Validator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Validation class
 */
class Validator {
    /**
     * @property {String} defaultRegex Default RegExp to match
     * @property {Object} matches Object containing keys to match and relative RegExp and error messages
     * @property {Array} forbidden Array of objects containing RegExp to match forbidden strings and relative error messages
     */
    constructor() {
        this.defaultRegex = /^[\w\'"\.()\-!\?\s]+$/
        this.matches = {
            email: {
                filter: /^\w+([\-\.]?\w+)*@\w+([\-\.]?\w+)*\.[\w]+$/,
                message: 'Adresse e-mail non valide !'
            },
            password: {
                filter: [/^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[^\w\d\s:])([^\s]){8,}$/, /^[^\\\/\$']+$/],
                message: [
                    'Le mot de passe doit comporter au minimum 8 caractères, dont au moins une lettre minuscule, une majuscule, un chiffre et un caractère spécial',
                    'Le mot de passe ne peut pas inclure les caractères \\, /, &lt;, >, \' ou $'
                ]
            },
            name: { filter: this.defaultRegex, message: 'Le nom du produit n\'est pas valide' },
            manufacturer: { filter: this.defaultRegex, message: 'Le nom du fabricant n\'est pas valide' },
            mainPepper: { filter: this.defaultRegex, message: 'Le nom de l\'ingrédient n\'est pas valide' }
        }
        this.forbidden = [
            {
                // HTML tags
                filter: /&lt;(!|\/)?[a-z\-]+(\s[a-z\-]+(=('|")?[\w:;\/\.\-\s]+('|")?)?)*\s?\/?>/gmi,
                message: 'Attention: les balises HTML sont interdites !'
            },
            {
                // SQL instructions
                filter: /[A-Z]+\s[\w\.\*]+(\s[A-Z]+\s[\w\.]+\s?)+(([A-Z]{5}\s[\w\.]+\s?=('|"|\s)?[\w\.]+('|"|\s)?)*((\s[A-Z]+)((\s[\w\.]+)?)*)?;?([A-Z\s]+[a-z]+)?\s?\n?)?$/gm,
                message: 'Attention: il est interdit d\'insérer des instructions SQL !'
            }
        ]
    }

    /**
     * Tests users' inputs with regular expressions
     * @param {Object} userInputs Object containing inputs to test
     * @returns {Error|Boolean} Returns an error if the test result is false, or returns true
     */
    test(userInputs) {
        for (let key in userInputs) {
            this.forbidden.map(regex => { if (regex.filter.test(userInputs[key])) throw new Error(regex.message) })

            if (this.matches[key]) {
                if (Array.isArray(this.matches[key].filter)) {
                    for (let i=0; i &lt; this.matches[key].filter.length; ++i) {
                        if (!this.matches[key].filter[i].test(userInputs[key])) throw new Error(this.matches[key].message[i])
                    }
                } else {
                    if (!this.matches[key].filter.test(userInputs[key])) throw new Error(this.matches[key].message)
                }
            }
        }
        return true
    }

    /**
     * Removes forbidden strings or useless characters from the inputs
     * @param {Object} userInputs Object containing inputs to sanitize
     * @return {Object} Returns sanitized object
     */
    sanitize(inputs) {
        let sanitizedInputs = {}

        for (let key in inputs) {
            if (typeof inputs[key] === 'string') {
                sanitizedInputs[key] = inputs[key].trim()
            }
        }
        return sanitizedInputs
    }
}

export default Validator</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Models_Sauce.html">Models/Sauce</a></li><li><a href="module-Models_User.html">Models/User</a></li><li><a href="module-Routes_Sauce.html">Routes/Sauce</a></li><li><a href="module-Routes_User.html">Routes/User</a></li></ul><h3>Classes</h3><ul><li><a href="Database.html">Database</a></li><li><a href="SauceController.html">SauceController</a></li><li><a href="Security.html">Security</a></li><li><a href="UserController.html">UserController</a></li><li><a href="Validator.html">Validator</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Sun Jun 06 2021 19:02:02 GMT+0200 (heure d’été d’Europe centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
